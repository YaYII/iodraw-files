```mermaid
@startuml
title MQTT 消息流转时序图（持久会话+订阅/取消订阅）

' 定义参与者
participant "客户端B\n(订阅者/固定ClientId:B_001)" as ClientB
participant "MQTT Broker\n(云服务/本地服务器)" as Broker
participant "客户端A\n(发布者)" as ClientA

' 设置时序图样式
autonumber
skinparam participant {
    BackgroundColor #f0f8ff
    BorderColor #2f4f4f
}
skinparam note {
    BackgroundColor #f8f8ff
    BorderColor #999999
}

== 1. 建立连接（持久会话） ==
ClientB -> Broker: CONNECT\n(Clean Session=false, ClientId=B_001)
Broker --> ClientB: CONNACK\n(确认连接，恢复持久会话)

== 2. 订阅主题 ==
ClientB -> Broker: SUBSCRIBE\n(订阅主题：sensor/temp)
Broker --> ClientB: SUBACK\n(确认订阅成功，持久化订阅关系)

== 3. 发布+转发消息（QoS 1） ==
ClientA -> Broker: PUBLISH\n(主题：sensor/temp, 消息：25℃, QoS=1)
Broker --> ClientB: PUBLISH\n(转发消息：25℃)
ClientB -> Broker: PUBACK\n(确认接收消息)
Broker --> ClientA: PUBACK\n(告知发布者消息投递成功)

== 4. 取消订阅 ==
ClientB -> Broker: UNSUBSCRIBE\n(取消订阅：sensor/temp)
Broker --> ClientB: UNSUBACK\n(确认取消，移除订阅关系)

== 5. 断开连接（保留会话） ==
ClientB -> Broker: DISCONNECT\n(断开连接)
note right of Broker: 保留ClientB的其余会话状态\n（未取消的订阅/未确认消息）

@enduml
```